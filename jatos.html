<!DOCTYPE html>
<html>
    <head>
        <title>Stroop Control</title>
		<script src="/assets/javascripts/jatos.js"></script>
		<script src="jspsych-6.1.0/jspsych.js"></script>
		<script src="jspsych-6.1.0/plugins/jspsych-image-audio-response.js"></script>
		<script src="jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
		<link rel="stylesheet" href="jspsych-6.1.0/css/jspsych.css"></link>
		<style></style>
    </head>
    <body></body>
	<script>
		
		var num_blocks = 2;

		var timeline = []; // initialise timeline
		
		/* intro to the recording trial */
		var participant_test = {
			type: 'image-audio-response',
			stimulus: 'stimuli/tiny-welcome.png',
			prompt: "<p>You first must allow microphone access in your browser.<br>Once that's done, recording will start. You can see the recording indicator at the bottom right of the screen. Test it out!<br><br> This example trial records for 6 seconds. Speak, and at the end you can play it back or rerecord as you like.<br>In the experiment itself, you will not be able to playback, or rerecord.</p>",
			allow_playback: true,
			buffer_length: 6000,
			wait_for_mic_approval: true,
			recording_light: '<div style="position: fixed; bottom: 0; right: 0;">recording...</div>',
			recording_light_off: '<div style="position: fixed; bottom: 0; right: 0;">not recording...</div>'
		}
		timeline.push(participant_test);

		/* stroop task */
		var stroop_task = {
			timeline: [
				{
					type: 'html-keyboard-response',
					stimulus: '<div style="font-size:60px;">+</div>',
					choices: jsPsych.NO_KEYS,
					trial_duration: 300
				},
				{
					type: 'image-audio-response',
					stimulus: jsPsych.timelineVariable('stim_path'),
					allow_playback: false,
					buffer_length: 2000,
					wait_for_mic_approval: false,
					recording_light: '<div style="position: fixed; bottom: 0; right: 0;">recording...</div>',
					recording_light_off: '<div style="position: fixed; bottom: 0; right: 0;">not recording...</div>',
					data: jsPsych.timelineVariable('add_data')
				}
			],
			timeline_variables: [
				{stim_path: 'stimuli/pink-pink-sm.png', add_data: {stimulus: 'pink-pink-small'}},
				{stim_path: 'stimuli/pink-pink-sm.png', add_data: {stimulus: 'pink-pink-small'}},
				{stim_path: 'stimuli/pink-blue-sm.png', add_data: {stimulus: 'pink-blue-small'}},
				{stim_path: 'stimuli/pink-gold-sm.png', add_data: {stimulus: 'pink-gold-small'}},
				{stim_path: 'stimuli/blue-blue-sm.png', add_data: {stimulus: 'blue-blue-small'}},
				{stim_path: 'stimuli/blue-blue-sm.png', add_data: {stimulus: 'blue-blue-small'}},
				{stim_path: 'stimuli/blue-pink-sm.png', add_data: {stimulus: 'blue-pink-small'}},
				{stim_path: 'stimuli/blue-gold-sm.png', add_data: {stimulus: 'blue-gold-small'}},
				{stim_path: 'stimuli/gold-gold-sm.png', add_data: {stimulus: 'gold-gold-small'}},
				{stim_path: 'stimuli/gold-gold-sm.png', add_data: {stimulus: 'gold-gold-small'}},
				{stim_path: 'stimuli/gold-pink-sm.png', add_data: {stimulus: 'gold-pink-small'}},
				{stim_path: 'stimuli/gold-blue-sm.png', add_data: {stimulus: 'gold-blue-small'}},
				{stim_path: 'stimuli/pink-pink-md.png', add_data: {stimulus: 'pink-pink-mid'}},
				{stim_path: 'stimuli/pink-pink-md.png', add_data: {stimulus: 'pink-pink-mid'}},
				{stim_path: 'stimuli/pink-blue-md.png', add_data: {stimulus: 'pink-blue-mid'}},
				{stim_path: 'stimuli/pink-gold-md.png', add_data: {stimulus: 'pink-gold-mid'}},
				{stim_path: 'stimuli/blue-blue-md.png', add_data: {stimulus: 'blue-blue-mid'}},
				{stim_path: 'stimuli/blue-blue-md.png', add_data: {stimulus: 'blue-blue-mid'}},
				{stim_path: 'stimuli/blue-pink-md.png', add_data: {stimulus: 'blue-pink-mid'}},
				{stim_path: 'stimuli/blue-gold-md.png', add_data: {stimulus: 'blue-gold-mid'}},
				{stim_path: 'stimuli/gold-gold-md.png', add_data: {stimulus: 'gold-gold-mid'}},
				{stim_path: 'stimuli/gold-gold-md.png', add_data: {stimulus: 'gold-gold-mid'}},
				{stim_path: 'stimuli/gold-pink-md.png', add_data: {stimulus: 'gold-pink-mid'}},
				{stim_path: 'stimuli/gold-blue-md.png', add_data: {stimulus: 'gold-blue-mid'}},
				{stim_path: 'stimuli/pink-pink-lg.png', add_data: {stimulus: 'pink-pink-large'}},
				{stim_path: 'stimuli/pink-pink-lg.png', add_data: {stimulus: 'pink-pink-large'}},
				{stim_path: 'stimuli/pink-blue-lg.png', add_data: {stimulus: 'pink-blue-large'}},
				{stim_path: 'stimuli/pink-gold-lg.png', add_data: {stimulus: 'pink-gold-large'}},
				{stim_path: 'stimuli/blue-blue-lg.png', add_data: {stimulus: 'blue-blue-large'}},
				{stim_path: 'stimuli/blue-blue-lg.png', add_data: {stimulus: 'blue-blue-large'}},
				{stim_path: 'stimuli/blue-pink-lg.png', add_data: {stimulus: 'blue-pink-large'}},
				{stim_path: 'stimuli/blue-gold-lg.png', add_data: {stimulus: 'blue-gold-large'}},
				{stim_path: 'stimuli/gold-gold-lg.png', add_data: {stimulus: 'gold-gold-large'}},
				{stim_path: 'stimuli/gold-gold-lg.png', add_data: {stimulus: 'gold-gold-large'}},
				{stim_path: 'stimuli/gold-pink-lg.png', add_data: {stimulus: 'gold-pink-large'}},
				{stim_path: 'stimuli/gold-blue-lg.png', add_data: {stimulus: 'gold-blue-large'}},
			],
			randomize_order: true,
			repetitions: num_blocks
		}
		timeline.push(stroop_task);

		/* initialise experiment */
		jatos.onLoad(function() {
			jsPsych.init({
				timeline: timeline,
				on_finish: function() {
					var resultJson = jsPsych.data.get().json();
					jatos.submitResultData(resultJson, jatos.startNextComponent);
				}
			});
		});

	</script>
</html>
